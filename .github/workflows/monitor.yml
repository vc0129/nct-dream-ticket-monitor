name: NCT DREAM Ticket Monitor

on:
  schedule:
    # æ¯ 5 åˆ†é˜æª¢æŸ¥ä¸€æ¬¡
    - cron: '*/5 * * * *'
  # ä¹Ÿå¯ä»¥æ‰‹å‹•è§¸ç™¼
  workflow_dispatch:

jobs:
  monitor:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      - name: Check Melon Ticket Availability
        id: check
        uses: mooyoul/melon-ticket-actions@v1.1.0
        with:
          product-id: 212676
          # ç•¶é–€ç¥¨é–‹å”®å¾Œï¼Œéœ€è¦æ›´æ–°ä»¥ä¸‹å…©å€‹ ID
          # è«‹ä½¿ç”¨ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·å¾é é¢ä¸­æ‰¾å‡ºé€™äº›å€¼
          schedule-id: 100001  # éœ€è¦æ›´æ–°
          seat-id: 1_0         # éœ€è¦æ›´æ–°
          slack-incoming-webhook-url: ${{ secrets.DISCORD_WEBHOOK_URL }}
          message: 'ğŸ« NCT DREAM é–€ç¥¨æœ‰è²¨äº†ï¼å¿«å»æ¶ç¥¨ï¼'
      
      # å¦‚æœä¸Šé¢çš„ Slack webhook æ ¼å¼ä¸é©ç”¨æ–¼ Discord
      # å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ Discord å°ˆç”¨çš„é€šçŸ¥æ­¥é©Ÿ
      - name: Send Discord Notification
        if: success()
        uses: sarisia/actions-status-discord@v1
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          title: 'ğŸ« NCT DREAM é–€ç¥¨æé†’'
          description: 'é–€ç¥¨å¯èƒ½æœ‰è²¨äº†ï¼è«‹ç«‹å³æŸ¥çœ‹ Melon Ticketï¼'
          url: 'https://tkglobal.melon.com/performance/index.htm?langCd=EN&prodId=212676'
